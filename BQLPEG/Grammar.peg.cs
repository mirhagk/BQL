// -----------------------------------------------------------------------
// <auto-generated>
//   This code was generated by Pegasus 3.1.0.0
//
//   Changes to this file may cause incorrect behavior and will be lost if
//   the code is regenerated.
// </auto-generated>
// -----------------------------------------------------------------------

namespace
#line 1 "Grammar.peg"
           BQLPEG
#line default
{
    using System;
    using System.Collections.Generic;
    using Pegasus.Common;
    using
        #line 2 "Grammar.peg"
       BQLPEG.Nodes
        #line default
        ;
    using
        #line 3 "Grammar.peg"
       System.Linq
        #line default
        ;

    /// <summary>
    ///  Parses a string according to the rules of the <see cref="Parser" /> grammar.
    /// </summary>
    [System.CodeDom.Compiler.GeneratedCode("Pegasus", "3.1.0.0")]
    public
    partial class
    Parser
    {
        private Dictionary<string, object> storage;

        /// <summary>
        ///  Parses a string according to the rules of the <see cref="Parser" /> grammar.
        /// </summary>
        /// <param name="subject">The parsing subject.</param>
        /// <param name="fileName">The optional file name to use in error messages.</param>
        /// <returns>The <see cref="IEnumerable&lt;StatementNode&gt;" /> parsed from <paramref name="subject" />.</returns>
        /// <exception cref="FormatException">
        ///  Thrown when parsing fails against <paramref name="subject"/>.  The exception's <code>Data["cursor"]</code> will be set with the cursor where the fatal error occurred.
        /// </exception>
        public IEnumerable<StatementNode> Parse(string subject, string fileName = null)
        {
            try
            {
                this.storage = new Dictionary<string, object>();
                var cursor = new Cursor(subject, 0, fileName);
                var result = this.Root(ref cursor);
                if (result == null)
                {
                    throw ExceptionHelper(cursor, state => "Failed to parse 'Root'.");
                }
                return result.Value;
            }
            finally
            {
                this.storage = null;
            }
        }

        private IParseResult<IEnumerable<StatementNode>> Root(ref Cursor cursor)
        {
            IParseResult<IEnumerable<StatementNode>> r0 = null;
            r0 = this.stmtList(ref cursor);
            return r0;
        }

        private IParseResult<
            #line 5 "Grammar.peg"
          StatementNode
            #line default
            > stmtLine(ref Cursor cursor)
        {
            IParseResult<StatementNode> r0 = null;
            var startCursor0 = cursor;
            IParseResult<StatementNode> r1 = null;
            var stmtStart = cursor;
            r1 = this.stmt(ref cursor);
            var stmtEnd = cursor;
            var stmt = ValueOrDefault(r1);
            if (r1 != null)
            {
                IParseResult<IList<string>> r2 = null;
                var startCursor1 = cursor;
                var l0 = new List<string>();
                while (l0.Count < 1)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.ParseLiteral(ref cursor, ";");
                    if (r3 != null)
                    {
                        l0.Add(r3.Value);
                    }
                    else
                    {
                        break;
                    }
                }
                r2 = this.ReturnHelper<IList<string>>(startCursor1, ref cursor, state => l0.AsReadOnly());
                if (r2 != null)
                {
                    r0 = this.ReturnHelper<StatementNode>(startCursor0, ref cursor, state =>
                        #line 5 "Grammar.peg"
                                           stmt
                        #line default
                        );
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<
            #line 6 "Grammar.peg"
          IEnumerable<StatementNode>
            #line default
            > stmtList(ref Cursor cursor)
        {
            IParseResult<IEnumerable<StatementNode>> r0 = null;
            var startCursor0 = cursor;
            var l0 = new List<StatementNode>();
            while (true)
            {
                IParseResult<StatementNode> r1 = null;
                r1 = this.stmtLine(ref cursor);
                if (r1 != null)
                {
                    l0.Add(r1.Value);
                }
                else
                {
                    break;
                }
            }
            if (l0.Count >= 1)
            {
                r0 = this.ReturnHelper<IList<StatementNode>>(startCursor0, ref cursor, state => l0.AsReadOnly());
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<
            #line 7 "Grammar.peg"
    string
            #line default
            > Id(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<IList<string>> r1 = null;
            var idStart = cursor;
            var startCursor1 = cursor;
            var l0 = new List<string>();
            while (true)
            {
                var startCursor2 = cursor;
                if (l0.Count > 0)
                {
                    IParseResult<string> r2 = null;
                    r2 = this.dot(ref cursor);
                    if (r2 == null)
                    {
                        break;
                    }
                }
                IParseResult<string> r3 = null;
                r3 = this.Id_simple(ref cursor);
                if (r3 != null)
                {
                    l0.Add(r3.Value);
                }
                else
                {
                    cursor = startCursor2;
                    break;
                }
            }
            if (l0.Count >= 1)
            {
                r1 = this.ReturnHelper<IList<string>>(startCursor1, ref cursor, state => l0.AsReadOnly());
            }
            else
            {
                cursor = startCursor1;
            }
            var idEnd = cursor;
            var id = ValueOrDefault(r1);
            if (r1 != null)
            {
                r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                    #line 7 "Grammar.peg"
                                     string.Concat(id)
                    #line default
                    );
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<
            #line 8 "Grammar.peg"
      StatementNode
            #line default
            > stmt(ref Cursor cursor)
        {
            IParseResult<StatementNode> r0 = null;
            if (r0 == null)
            {
                r0 = this.createTableStmt(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.createIndexStmt(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.alterStmt(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.dropTableStmt(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.dropIndexStmt(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.selectStmt(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.insertStmt(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.updateStmt(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.deleteStmt(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.projectionDecl(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "GO");
            }
            return r0;
        }

        private IParseResult<
            #line 9 "Grammar.peg"
                 CreateTableNode
            #line default
            > createTableStmt(ref Cursor cursor)
        {
            IParseResult<CreateTableNode> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.CREATE(ref cursor);
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.TABLE(ref cursor);
                if (r2 != null)
                {
                    IParseResult<string> r3 = null;
                    var idStart = cursor;
                    r3 = this.Id(ref cursor);
                    var idEnd = cursor;
                    var id = ValueOrDefault(r3);
                    if (r3 != null)
                    {
                        IParseResult<string> r4 = null;
                        r4 = this.ParseLiteral(ref cursor, "(");
                        if (r4 != null)
                        {
                            IParseResult<IList<FieldNode>> r5 = null;
                            var fieldsStart = cursor;
                            r5 = this.fieldDefList(ref cursor);
                            var fieldsEnd = cursor;
                            var fields = ValueOrDefault(r5);
                            if (r5 != null)
                            {
                                IParseResult<string> r6 = null;
                                r6 = this.ParseLiteral(ref cursor, ")");
                                if (r6 != null)
                                {
                                    IParseResult<IList<ConstraintNode>> r7 = null;
                                    var constraintsStart = cursor;
                                    r7 = this.constraintListOpt(ref cursor);
                                    var constraintsEnd = cursor;
                                    var constraints = ValueOrDefault(r7);
                                    if (r7 != null)
                                    {
                                        r0 = this.ReturnHelper<CreateTableNode>(startCursor0, ref cursor, state =>
                                            #line 9 "Grammar.peg"
                                                                                                                  new CreateTableNode{Name=id, Fields=fields, Constraints=constraints}
                                            #line default
                                            );
                                    }
                                    else
                                    {
                                        cursor = startCursor0;
                                    }
                                }
                                else
                                {
                                    cursor = startCursor0;
                                }
                            }
                            else
                            {
                                cursor = startCursor0;
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<IList<FieldNode>> fieldDefList(ref Cursor cursor)
        {
            IParseResult<IList<FieldNode>> r0 = null;
            var startCursor0 = cursor;
            var l0 = new List<FieldNode>();
            while (true)
            {
                var startCursor1 = cursor;
                if (l0.Count > 0)
                {
                    IParseResult<string> r1 = null;
                    r1 = this.comma(ref cursor);
                    if (r1 == null)
                    {
                        break;
                    }
                }
                IParseResult<FieldNode> r2 = null;
                r2 = this.fieldDef(ref cursor);
                if (r2 != null)
                {
                    l0.Add(r2.Value);
                }
                else
                {
                    cursor = startCursor1;
                    break;
                }
            }
            if (l0.Count >= 1)
            {
                r0 = this.ReturnHelper<IList<FieldNode>>(startCursor0, ref cursor, state => l0.AsReadOnly());
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<
            #line 11 "Grammar.peg"
          FieldNode
            #line default
            > fieldDef(ref Cursor cursor)
        {
            IParseResult<FieldNode> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            var idStart = cursor;
            r1 = this.Id(ref cursor);
            var idEnd = cursor;
            var id = ValueOrDefault(r1);
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                var typeStart = cursor;
                r2 = this.typeName(ref cursor);
                var typeEnd = cursor;
                var type = ValueOrDefault(r2);
                if (r2 != null)
                {
                    IParseResult<IList<IEnumerable<int>>> r3 = null;
                    var typeParamsStart = cursor;
                    var startCursor1 = cursor;
                    var l0 = new List<IEnumerable<int>>();
                    while (l0.Count < 1)
                    {
                        IParseResult<IEnumerable<int>> r4 = null;
                        r4 = this.typeParams(ref cursor);
                        if (r4 != null)
                        {
                            l0.Add(r4.Value);
                        }
                        else
                        {
                            break;
                        }
                    }
                    r3 = this.ReturnHelper<IList<IEnumerable<int>>>(startCursor1, ref cursor, state => l0.AsReadOnly());
                    var typeParamsEnd = cursor;
                    var typeParams = ValueOrDefault(r3);
                    if (r3 != null)
                    {
                        IParseResult<bool> r5 = null;
                        var nullStart = cursor;
                        r5 = this.nullOpt(ref cursor);
                        var nullEnd = cursor;
                        var @null = ValueOrDefault(r5);
                        if (r5 != null)
                        {
                            r0 = this.ReturnHelper<FieldNode>(startCursor0, ref cursor, state =>
                                #line 11 "Grammar.peg"
                                                                                new FieldNode{Name=id, Type=type, TypeParams=typeParams.SingleOrDefault(), Nullable=null??true}
                                #line default
                                );
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> typeName(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "BIT");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "DATE");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "TIME");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "TIMESTAMP");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "DECIMAL");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "REAL");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "FLOAT");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "SMALLINT");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "INTEGER");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "INTERVAL");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "CHARACTER");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "DATETIME");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "INT");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "DOUBLE");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "CHAR");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "NCHAR");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "VARCHAR");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "NVARCHAR");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "IMAGE");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "TEXT");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "NTEXT");
            }
            return r0;
        }

        private IParseResult<
            #line 13 "Grammar.peg"
            IEnumerable<int>
            #line default
            > typeParams(ref Cursor cursor)
        {
            IParseResult<IEnumerable<int>> r0 = null;
            if (r0 == null)
            {
                var startCursor0 = cursor;
                IParseResult<string> r1 = null;
                r1 = this.ParseLiteral(ref cursor, "(");
                if (r1 != null)
                {
                    IParseResult<string> r2 = null;
                    var numStart = cursor;
                    r2 = this.number(ref cursor);
                    var numEnd = cursor;
                    var num = ValueOrDefault(r2);
                    if (r2 != null)
                    {
                        IParseResult<string> r3 = null;
                        r3 = this.ParseLiteral(ref cursor, ")");
                        if (r3 != null)
                        {
                            r0 = this.ReturnHelper<IEnumerable<int>>(startCursor0, ref cursor, state =>
                                #line 13 "Grammar.peg"
                                                     new int[]{int.Parse(num)}
                                #line default
                                );
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            if (r0 == null)
            {
                var startCursor1 = cursor;
                IParseResult<string> r4 = null;
                r4 = this.ParseLiteral(ref cursor, "(");
                if (r4 != null)
                {
                    IParseResult<string> r5 = null;
                    var num1Start = cursor;
                    r5 = this.number(ref cursor);
                    var num1End = cursor;
                    var num1 = ValueOrDefault(r5);
                    if (r5 != null)
                    {
                        IParseResult<string> r6 = null;
                        r6 = this.comma(ref cursor);
                        if (r6 != null)
                        {
                            IParseResult<string> r7 = null;
                            var num2Start = cursor;
                            r7 = this.number(ref cursor);
                            var num2End = cursor;
                            var num2 = ValueOrDefault(r7);
                            if (r7 != null)
                            {
                                IParseResult<string> r8 = null;
                                r8 = this.ParseLiteral(ref cursor, ")");
                                if (r8 != null)
                                {
                                    r0 = this.ReturnHelper<IEnumerable<int>>(startCursor1, ref cursor, state =>
                                        #line 13 "Grammar.peg"
                                                                                                                        new int[]{int.Parse(num1),int.Parse(num2)}
                                        #line default
                                        );
                                }
                                else
                                {
                                    cursor = startCursor1;
                                }
                            }
                            else
                            {
                                cursor = startCursor1;
                            }
                        }
                        else
                        {
                            cursor = startCursor1;
                        }
                    }
                    else
                    {
                        cursor = startCursor1;
                    }
                }
                else
                {
                    cursor = startCursor1;
                }
            }
            return r0;
        }

        private IParseResult<
            #line 14 "Grammar.peg"
         bool
            #line default
            > nullOpt(ref Cursor cursor)
        {
            IParseResult<bool> r0 = null;
            var startCursor0 = cursor;
            var l0 = new List<string>();
            while (l0.Count < 1)
            {
                IParseResult<string> r1 = null;
                if (r1 == null)
                {
                    var startCursor1 = cursor;
                    IParseResult<string> r2 = null;
                    r2 = this.NULL(ref cursor);
                    if (r2 != null)
                    {
                        r1 = this.ReturnHelper<string>(startCursor1, ref cursor, state =>
                            #line 14 "Grammar.peg"
                        true
                            #line default
                            );
                    }
                    else
                    {
                        cursor = startCursor1;
                    }
                }
                if (r1 == null)
                {
                    var startCursor2 = cursor;
                    IParseResult<string> r3 = null;
                    r3 = this.NOT(ref cursor);
                    if (r3 != null)
                    {
                        IParseResult<string> r4 = null;
                        r4 = this.NULL(ref cursor);
                        if (r4 != null)
                        {
                            r1 = this.ReturnHelper<string>(startCursor2, ref cursor, state =>
                                #line 14 "Grammar.peg"
                                        false
                                #line default
                                );
                        }
                        else
                        {
                            cursor = startCursor2;
                        }
                    }
                    else
                    {
                        cursor = startCursor2;
                    }
                }
                if (r1 != null)
                {
                    l0.Add(r1.Value);
                }
                else
                {
                    break;
                }
            }
            r0 = this.ReturnHelper<IList<string>>(startCursor0, ref cursor, state => l0.AsReadOnly());
            return r0;
        }

        private IParseResult<
            #line 15 "Grammar.peg"
               ConstraintNode
            #line default
            > constraintDef(ref Cursor cursor)
        {
            IParseResult<ConstraintNode> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.CONSTRAINT(ref cursor);
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                var idStart = cursor;
                r2 = this.Id(ref cursor);
                var idEnd = cursor;
                var id = ValueOrDefault(r2);
                if (r2 != null)
                {
                    IParseResult<ConstraintTypeNode> r3 = null;
                    var constraintTypeStart = cursor;
                    r3 = this.constraintTypeOpt(ref cursor);
                    var constraintTypeEnd = cursor;
                    var constraintType = ValueOrDefault(r3);
                    if (r3 != null)
                    {
                        r0 = this.ReturnHelper<ConstraintNode>(startCursor0, ref cursor, state =>
                            #line 15 "Grammar.peg"
                                                                                    new ConstraintNode{ Name=id, ConstraintType=constraintType}
                            #line default
                            );
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<IList<ConstraintNode>> constraintListOpt(ref Cursor cursor)
        {
            IParseResult<IList<ConstraintNode>> r0 = null;
            var startCursor0 = cursor;
            var l0 = new List<ConstraintNode>();
            while (true)
            {
                IParseResult<ConstraintNode> r1 = null;
                r1 = this.constraintDef(ref cursor);
                if (r1 != null)
                {
                    l0.Add(r1.Value);
                }
                else
                {
                    break;
                }
            }
            r0 = this.ReturnHelper<IList<ConstraintNode>>(startCursor0, ref cursor, state => l0.AsReadOnly());
            return r0;
        }

        private IParseResult<
            #line 17 "Grammar.peg"
                   ConstraintTypeNode
            #line default
            > constraintTypeOpt(ref Cursor cursor)
        {
            IParseResult<ConstraintTypeNode> r0 = null;
            if (r0 == null)
            {
                var startCursor0 = cursor;
                IParseResult<string> r1 = null;
                r1 = this.PRIMARY(ref cursor);
                if (r1 != null)
                {
                    IParseResult<string> r2 = null;
                    r2 = this.KEY(ref cursor);
                    if (r2 != null)
                    {
                        IParseResult<IList<string>> r3 = null;
                        var idsStart = cursor;
                        r3 = this.idlistPar(ref cursor);
                        var idsEnd = cursor;
                        var ids = ValueOrDefault(r3);
                        if (r3 != null)
                        {
                            r0 = this.ReturnHelper<ConstraintTypeNode>(startCursor0, ref cursor, state =>
                                #line 17 "Grammar.peg"
                                                                    new PKConstraintTypeNode{Ids=ids}
                                #line default
                                );
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            if (r0 == null)
            {
                var startCursor1 = cursor;
                IParseResult<string> r4 = null;
                r4 = this.UNIQUE(ref cursor);
                if (r4 != null)
                {
                    IParseResult<IList<string>> r5 = null;
                    r5 = this.idlistPar(ref cursor);
                    if (r5 != null)
                    {
                        {
                            var len = cursor.Location - startCursor1.Location;
                            r0 = this.ReturnHelper<ConstraintTypeNode>(startCursor1, ref cursor, state =>
                                state.Subject.Substring(startCursor1.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor1;
                    }
                }
                else
                {
                    cursor = startCursor1;
                }
            }
            if (r0 == null)
            {
                var startCursor2 = cursor;
                IParseResult<string> r6 = null;
                r6 = this.NOT(ref cursor);
                if (r6 != null)
                {
                    IParseResult<string> r7 = null;
                    r7 = this.NULL(ref cursor);
                    if (r7 != null)
                    {
                        IParseResult<IList<string>> r8 = null;
                        r8 = this.idlistPar(ref cursor);
                        if (r8 != null)
                        {
                            {
                                var len = cursor.Location - startCursor2.Location;
                                r0 = this.ReturnHelper<ConstraintTypeNode>(startCursor2, ref cursor, state =>
                                    state.Subject.Substring(startCursor2.Location, len)
                                    );
                            }
                        }
                        else
                        {
                            cursor = startCursor2;
                        }
                    }
                    else
                    {
                        cursor = startCursor2;
                    }
                }
                else
                {
                    cursor = startCursor2;
                }
            }
            if (r0 == null)
            {
                var startCursor3 = cursor;
                IParseResult<string> r9 = null;
                r9 = this.ParseLiteral(ref cursor, "FOREIGN");
                if (r9 != null)
                {
                    IParseResult<string> r10 = null;
                    r10 = this.KEY(ref cursor);
                    if (r10 != null)
                    {
                        IParseResult<IList<string>> r11 = null;
                        r11 = this.idlistPar(ref cursor);
                        if (r11 != null)
                        {
                            IParseResult<string> r12 = null;
                            r12 = this.ParseLiteral(ref cursor, "REFERENCES");
                            if (r12 != null)
                            {
                                IParseResult<string> r13 = null;
                                r13 = this.Id(ref cursor);
                                if (r13 != null)
                                {
                                    IParseResult<IList<string>> r14 = null;
                                    r14 = this.idlistPar(ref cursor);
                                    if (r14 != null)
                                    {
                                        {
                                            var len = cursor.Location - startCursor3.Location;
                                            r0 = this.ReturnHelper<ConstraintTypeNode>(startCursor3, ref cursor, state =>
                                                state.Subject.Substring(startCursor3.Location, len)
                                                );
                                        }
                                    }
                                    else
                                    {
                                        cursor = startCursor3;
                                    }
                                }
                                else
                                {
                                    cursor = startCursor3;
                                }
                            }
                            else
                            {
                                cursor = startCursor3;
                            }
                        }
                        else
                        {
                            cursor = startCursor3;
                        }
                    }
                    else
                    {
                        cursor = startCursor3;
                    }
                }
                else
                {
                    cursor = startCursor3;
                }
            }
            return r0;
        }

        private IParseResult<
            #line 18 "Grammar.peg"
           IList<string>
            #line default
            > idlistPar(ref Cursor cursor)
        {
            IParseResult<IList<string>> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.ParseLiteral(ref cursor, "(");
            if (r1 != null)
            {
                IParseResult<IList<string>> r2 = null;
                var idsStart = cursor;
                r2 = this.idlist(ref cursor);
                var idsEnd = cursor;
                var ids = ValueOrDefault(r2);
                if (r2 != null)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.ParseLiteral(ref cursor, ")");
                    if (r3 != null)
                    {
                        r0 = this.ReturnHelper<IList<string>>(startCursor0, ref cursor, state =>
                            #line 18 "Grammar.peg"
                                                ids
                            #line default
                            );
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<IList<string>> idlist(ref Cursor cursor)
        {
            IParseResult<IList<string>> r0 = null;
            var startCursor0 = cursor;
            var l0 = new List<string>();
            while (true)
            {
                var startCursor1 = cursor;
                if (l0.Count > 0)
                {
                    IParseResult<string> r1 = null;
                    r1 = this.comma(ref cursor);
                    if (r1 == null)
                    {
                        break;
                    }
                }
                IParseResult<string> r2 = null;
                r2 = this.Id(ref cursor);
                if (r2 != null)
                {
                    l0.Add(r2.Value);
                }
                else
                {
                    cursor = startCursor1;
                    break;
                }
            }
            if (l0.Count >= 1)
            {
                r0 = this.ReturnHelper<IList<string>>(startCursor0, ref cursor, state => l0.AsReadOnly());
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> createIndexStmt(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.CREATE(ref cursor);
            if (r1 != null)
            {
                IParseResult<IList<string>> r2 = null;
                var startCursor1 = cursor;
                var l0 = new List<string>();
                while (l0.Count < 1)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.UNIQUE(ref cursor);
                    if (r3 != null)
                    {
                        l0.Add(r3.Value);
                    }
                    else
                    {
                        break;
                    }
                }
                r2 = this.ReturnHelper<IList<string>>(startCursor1, ref cursor, state => l0.AsReadOnly());
                if (r2 != null)
                {
                    IParseResult<string> r4 = null;
                    r4 = this.INDEX(ref cursor);
                    if (r4 != null)
                    {
                        IParseResult<string> r5 = null;
                        r5 = this.Id(ref cursor);
                        if (r5 != null)
                        {
                            IParseResult<string> r6 = null;
                            r6 = this.ON(ref cursor);
                            if (r6 != null)
                            {
                                IParseResult<string> r7 = null;
                                r7 = this.Id(ref cursor);
                                if (r7 != null)
                                {
                                    IParseResult<IList<string>> r8 = null;
                                    r8 = this.orderList(ref cursor);
                                    if (r8 != null)
                                    {
                                        IParseResult<IList<string>> r9 = null;
                                        var startCursor2 = cursor;
                                        var l1 = new List<string>();
                                        while (l1.Count < 1)
                                        {
                                            IParseResult<string> r10 = null;
                                            r10 = this.withClause(ref cursor);
                                            if (r10 != null)
                                            {
                                                l1.Add(r10.Value);
                                            }
                                            else
                                            {
                                                break;
                                            }
                                        }
                                        r9 = this.ReturnHelper<IList<string>>(startCursor2, ref cursor, state => l1.AsReadOnly());
                                        if (r9 != null)
                                        {
                                            {
                                                var len = cursor.Location - startCursor0.Location;
                                                r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                                    state.Subject.Substring(startCursor0.Location, len)
                                                    );
                                            }
                                        }
                                        else
                                        {
                                            cursor = startCursor0;
                                        }
                                    }
                                    else
                                    {
                                        cursor = startCursor0;
                                    }
                                }
                                else
                                {
                                    cursor = startCursor0;
                                }
                            }
                            else
                            {
                                cursor = startCursor0;
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<IList<string>> orderList(ref Cursor cursor)
        {
            IParseResult<IList<string>> r0 = null;
            var startCursor0 = cursor;
            var l0 = new List<string>();
            while (true)
            {
                var startCursor1 = cursor;
                if (l0.Count > 0)
                {
                    IParseResult<string> r1 = null;
                    r1 = this.comma(ref cursor);
                    if (r1 == null)
                    {
                        break;
                    }
                }
                IParseResult<string> r2 = null;
                r2 = this.orderMember(ref cursor);
                if (r2 != null)
                {
                    l0.Add(r2.Value);
                }
                else
                {
                    cursor = startCursor1;
                    break;
                }
            }
            if (l0.Count >= 1)
            {
                r0 = this.ReturnHelper<IList<string>>(startCursor0, ref cursor, state => l0.AsReadOnly());
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> orderMember(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.Id(ref cursor);
            if (r1 != null)
            {
                IParseResult<IList<string>> r2 = null;
                var startCursor1 = cursor;
                var l0 = new List<string>();
                while (l0.Count < 1)
                {
                    IParseResult<string> r3 = null;
                    if (r3 == null)
                    {
                        r3 = this.ParseLiteral(ref cursor, "ASC");
                    }
                    if (r3 == null)
                    {
                        r3 = this.ParseLiteral(ref cursor, "DESC");
                    }
                    if (r3 != null)
                    {
                        l0.Add(r3.Value);
                    }
                    else
                    {
                        break;
                    }
                }
                r2 = this.ReturnHelper<IList<string>>(startCursor1, ref cursor, state => l0.AsReadOnly());
                if (r2 != null)
                {
                    {
                        var len = cursor.Location - startCursor0.Location;
                        r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                            state.Subject.Substring(startCursor0.Location, len)
                            );
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> withClause(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            if (r0 == null)
            {
                var startCursor0 = cursor;
                IParseResult<string> r1 = null;
                r1 = this.WITH(ref cursor);
                if (r1 != null)
                {
                    IParseResult<string> r2 = null;
                    r2 = this.PRIMARY(ref cursor);
                    if (r2 != null)
                    {
                        {
                            var len = cursor.Location - startCursor0.Location;
                            r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                state.Subject.Substring(startCursor0.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            if (r0 == null)
            {
                var startCursor1 = cursor;
                IParseResult<string> r3 = null;
                r3 = this.WITH(ref cursor);
                if (r3 != null)
                {
                    IParseResult<string> r4 = null;
                    r4 = this.ParseLiteral(ref cursor, "DISALLOW");
                    if (r4 != null)
                    {
                        IParseResult<string> r5 = null;
                        r5 = this.NULL(ref cursor);
                        if (r5 != null)
                        {
                            {
                                var len = cursor.Location - startCursor1.Location;
                                r0 = this.ReturnHelper<string>(startCursor1, ref cursor, state =>
                                    state.Subject.Substring(startCursor1.Location, len)
                                    );
                            }
                        }
                        else
                        {
                            cursor = startCursor1;
                        }
                    }
                    else
                    {
                        cursor = startCursor1;
                    }
                }
                else
                {
                    cursor = startCursor1;
                }
            }
            if (r0 == null)
            {
                var startCursor2 = cursor;
                IParseResult<string> r6 = null;
                r6 = this.WITH(ref cursor);
                if (r6 != null)
                {
                    IParseResult<string> r7 = null;
                    r7 = this.ParseLiteral(ref cursor, "IGNORE");
                    if (r7 != null)
                    {
                        IParseResult<string> r8 = null;
                        r8 = this.NULL(ref cursor);
                        if (r8 != null)
                        {
                            {
                                var len = cursor.Location - startCursor2.Location;
                                r0 = this.ReturnHelper<string>(startCursor2, ref cursor, state =>
                                    state.Subject.Substring(startCursor2.Location, len)
                                    );
                            }
                        }
                        else
                        {
                            cursor = startCursor2;
                        }
                    }
                    else
                    {
                        cursor = startCursor2;
                    }
                }
                else
                {
                    cursor = startCursor2;
                }
            }
            return r0;
        }

        private IParseResult<string> alterStmt(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.ALTER(ref cursor);
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.TABLE(ref cursor);
                if (r2 != null)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.Id(ref cursor);
                    if (r3 != null)
                    {
                        IParseResult<string> r4 = null;
                        r4 = this.alterCmd(ref cursor);
                        if (r4 != null)
                        {
                            {
                                var len = cursor.Location - startCursor0.Location;
                                r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                    state.Subject.Substring(startCursor0.Location, len)
                                    );
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> alterCmd(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            if (r0 == null)
            {
                var startCursor0 = cursor;
                IParseResult<string> r1 = null;
                r1 = this.ADD(ref cursor);
                if (r1 != null)
                {
                    IParseResult<string> r2 = null;
                    r2 = this.COLUMN(ref cursor);
                    if (r2 != null)
                    {
                        IParseResult<IList<FieldNode>> r3 = null;
                        r3 = this.fieldDefList(ref cursor);
                        if (r3 != null)
                        {
                            IParseResult<IList<ConstraintNode>> r4 = null;
                            r4 = this.constraintListOpt(ref cursor);
                            if (r4 != null)
                            {
                                {
                                    var len = cursor.Location - startCursor0.Location;
                                    r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                        state.Subject.Substring(startCursor0.Location, len)
                                        );
                                }
                            }
                            else
                            {
                                cursor = startCursor0;
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            if (r0 == null)
            {
                var startCursor1 = cursor;
                IParseResult<string> r5 = null;
                r5 = this.ADD(ref cursor);
                if (r5 != null)
                {
                    IParseResult<ConstraintNode> r6 = null;
                    r6 = this.constraintDef(ref cursor);
                    if (r6 != null)
                    {
                        {
                            var len = cursor.Location - startCursor1.Location;
                            r0 = this.ReturnHelper<string>(startCursor1, ref cursor, state =>
                                state.Subject.Substring(startCursor1.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor1;
                    }
                }
                else
                {
                    cursor = startCursor1;
                }
            }
            if (r0 == null)
            {
                var startCursor2 = cursor;
                IParseResult<string> r7 = null;
                r7 = this.DROP(ref cursor);
                if (r7 != null)
                {
                    IParseResult<string> r8 = null;
                    r8 = this.COLUMN(ref cursor);
                    if (r8 != null)
                    {
                        IParseResult<string> r9 = null;
                        r9 = this.Id(ref cursor);
                        if (r9 != null)
                        {
                            {
                                var len = cursor.Location - startCursor2.Location;
                                r0 = this.ReturnHelper<string>(startCursor2, ref cursor, state =>
                                    state.Subject.Substring(startCursor2.Location, len)
                                    );
                            }
                        }
                        else
                        {
                            cursor = startCursor2;
                        }
                    }
                    else
                    {
                        cursor = startCursor2;
                    }
                }
                else
                {
                    cursor = startCursor2;
                }
            }
            if (r0 == null)
            {
                var startCursor3 = cursor;
                IParseResult<string> r10 = null;
                r10 = this.DROP(ref cursor);
                if (r10 != null)
                {
                    IParseResult<string> r11 = null;
                    r11 = this.CONSTRAINT(ref cursor);
                    if (r11 != null)
                    {
                        IParseResult<string> r12 = null;
                        r12 = this.Id(ref cursor);
                        if (r12 != null)
                        {
                            {
                                var len = cursor.Location - startCursor3.Location;
                                r0 = this.ReturnHelper<string>(startCursor3, ref cursor, state =>
                                    state.Subject.Substring(startCursor3.Location, len)
                                    );
                            }
                        }
                        else
                        {
                            cursor = startCursor3;
                        }
                    }
                    else
                    {
                        cursor = startCursor3;
                    }
                }
                else
                {
                    cursor = startCursor3;
                }
            }
            return r0;
        }

        private IParseResult<string> dropTableStmt(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.DROP(ref cursor);
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.TABLE(ref cursor);
                if (r2 != null)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.Id(ref cursor);
                    if (r3 != null)
                    {
                        {
                            var len = cursor.Location - startCursor0.Location;
                            r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                state.Subject.Substring(startCursor0.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> dropIndexStmt(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.DROP(ref cursor);
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.INDEX(ref cursor);
                if (r2 != null)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.Id(ref cursor);
                    if (r3 != null)
                    {
                        IParseResult<string> r4 = null;
                        r4 = this.ON(ref cursor);
                        if (r4 != null)
                        {
                            IParseResult<string> r5 = null;
                            r5 = this.Id(ref cursor);
                            if (r5 != null)
                            {
                                {
                                    var len = cursor.Location - startCursor0.Location;
                                    r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                        state.Subject.Substring(startCursor0.Location, len)
                                        );
                                }
                            }
                            else
                            {
                                cursor = startCursor0;
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> insertStmt(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.INSERT(ref cursor);
            if (r1 != null)
            {
                IParseResult<IList<string>> r2 = null;
                var startCursor1 = cursor;
                var l0 = new List<string>();
                while (l0.Count < 1)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.INTO(ref cursor);
                    if (r3 != null)
                    {
                        l0.Add(r3.Value);
                    }
                    else
                    {
                        break;
                    }
                }
                r2 = this.ReturnHelper<IList<string>>(startCursor1, ref cursor, state => l0.AsReadOnly());
                if (r2 != null)
                {
                    IParseResult<string> r4 = null;
                    r4 = this.Id(ref cursor);
                    if (r4 != null)
                    {
                        IParseResult<IList<string>> r5 = null;
                        r5 = this.idlistPar(ref cursor);
                        if (r5 != null)
                        {
                            IParseResult<string> r6 = null;
                            r6 = this.insertData(ref cursor);
                            if (r6 != null)
                            {
                                {
                                    var len = cursor.Location - startCursor0.Location;
                                    r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                        state.Subject.Substring(startCursor0.Location, len)
                                        );
                                }
                            }
                            else
                            {
                                cursor = startCursor0;
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> insertData(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            if (r0 == null)
            {
                r0 = this.selectStmt(ref cursor);
            }
            if (r0 == null)
            {
                var startCursor0 = cursor;
                IParseResult<string> r1 = null;
                r1 = this.VALUES(ref cursor);
                if (r1 != null)
                {
                    IParseResult<string> r2 = null;
                    r2 = this.ParseLiteral(ref cursor, "(");
                    if (r2 != null)
                    {
                        IParseResult<IList<string>> r3 = null;
                        r3 = this.exprList(ref cursor);
                        if (r3 != null)
                        {
                            IParseResult<string> r4 = null;
                            r4 = this.ParseLiteral(ref cursor, ")");
                            if (r4 != null)
                            {
                                {
                                    var len = cursor.Location - startCursor0.Location;
                                    r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                        state.Subject.Substring(startCursor0.Location, len)
                                        );
                                }
                            }
                            else
                            {
                                cursor = startCursor0;
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            return r0;
        }

        private IParseResult<string> updateStmt(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.UPDATE(ref cursor);
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.Id(ref cursor);
                if (r2 != null)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.SET(ref cursor);
                    if (r3 != null)
                    {
                        IParseResult<IList<string>> r4 = null;
                        r4 = this.assignList(ref cursor);
                        if (r4 != null)
                        {
                            IParseResult<IList<string>> r5 = null;
                            var startCursor1 = cursor;
                            var l0 = new List<string>();
                            while (l0.Count < 1)
                            {
                                IParseResult<string> r6 = null;
                                r6 = this.whereClause(ref cursor);
                                if (r6 != null)
                                {
                                    l0.Add(r6.Value);
                                }
                                else
                                {
                                    break;
                                }
                            }
                            r5 = this.ReturnHelper<IList<string>>(startCursor1, ref cursor, state => l0.AsReadOnly());
                            if (r5 != null)
                            {
                                {
                                    var len = cursor.Location - startCursor0.Location;
                                    r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                        state.Subject.Substring(startCursor0.Location, len)
                                        );
                                }
                            }
                            else
                            {
                                cursor = startCursor0;
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<IList<string>> assignList(ref Cursor cursor)
        {
            IParseResult<IList<string>> r0 = null;
            var startCursor0 = cursor;
            var l0 = new List<string>();
            while (true)
            {
                var startCursor1 = cursor;
                if (l0.Count > 0)
                {
                    IParseResult<string> r1 = null;
                    r1 = this.comma(ref cursor);
                    if (r1 == null)
                    {
                        break;
                    }
                }
                IParseResult<string> r2 = null;
                r2 = this.assignment(ref cursor);
                if (r2 != null)
                {
                    l0.Add(r2.Value);
                }
                else
                {
                    cursor = startCursor1;
                    break;
                }
            }
            if (l0.Count >= 1)
            {
                r0 = this.ReturnHelper<IList<string>>(startCursor0, ref cursor, state => l0.AsReadOnly());
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> assignment(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.Id(ref cursor);
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.ParseLiteral(ref cursor, "=");
                if (r2 != null)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.expression(ref cursor);
                    if (r3 != null)
                    {
                        {
                            var len = cursor.Location - startCursor0.Location;
                            r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                state.Subject.Substring(startCursor0.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> deleteStmt(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.DELETE(ref cursor);
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.FROM(ref cursor);
                if (r2 != null)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.Id(ref cursor);
                    if (r3 != null)
                    {
                        IParseResult<IList<string>> r4 = null;
                        var startCursor1 = cursor;
                        var l0 = new List<string>();
                        while (l0.Count < 1)
                        {
                            IParseResult<string> r5 = null;
                            r5 = this.whereClause(ref cursor);
                            if (r5 != null)
                            {
                                l0.Add(r5.Value);
                            }
                            else
                            {
                                break;
                            }
                        }
                        r4 = this.ReturnHelper<IList<string>>(startCursor1, ref cursor, state => l0.AsReadOnly());
                        if (r4 != null)
                        {
                            {
                                var len = cursor.Location - startCursor0.Location;
                                r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                    state.Subject.Substring(startCursor0.Location, len)
                                    );
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> selectStmt(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            if (r0 == null)
            {
                var startCursor0 = cursor;
                IParseResult<string> r1 = null;
                r1 = this.selectClause(ref cursor);
                if (r1 != null)
                {
                    IParseResult<IList<string>> r2 = null;
                    var startCursor1 = cursor;
                    var l0 = new List<string>();
                    while (l0.Count < 1)
                    {
                        IParseResult<string> r3 = null;
                        r3 = this.fromClause(ref cursor);
                        if (r3 != null)
                        {
                            l0.Add(r3.Value);
                        }
                        else
                        {
                            break;
                        }
                    }
                    r2 = this.ReturnHelper<IList<string>>(startCursor1, ref cursor, state => l0.AsReadOnly());
                    if (r2 != null)
                    {
                        IParseResult<IList<string>> r4 = null;
                        var startCursor2 = cursor;
                        var l1 = new List<string>();
                        while (l1.Count < 1)
                        {
                            IParseResult<string> r5 = null;
                            r5 = this.whereClause(ref cursor);
                            if (r5 != null)
                            {
                                l1.Add(r5.Value);
                            }
                            else
                            {
                                break;
                            }
                        }
                        r4 = this.ReturnHelper<IList<string>>(startCursor2, ref cursor, state => l1.AsReadOnly());
                        if (r4 != null)
                        {
                            IParseResult<IList<string>> r6 = null;
                            var startCursor3 = cursor;
                            var l2 = new List<string>();
                            while (l2.Count < 1)
                            {
                                IParseResult<string> r7 = null;
                                r7 = this.groupClause(ref cursor);
                                if (r7 != null)
                                {
                                    l2.Add(r7.Value);
                                }
                                else
                                {
                                    break;
                                }
                            }
                            r6 = this.ReturnHelper<IList<string>>(startCursor3, ref cursor, state => l2.AsReadOnly());
                            if (r6 != null)
                            {
                                IParseResult<IList<string>> r8 = null;
                                var startCursor4 = cursor;
                                var l3 = new List<string>();
                                while (l3.Count < 1)
                                {
                                    IParseResult<string> r9 = null;
                                    r9 = this.havingClause(ref cursor);
                                    if (r9 != null)
                                    {
                                        l3.Add(r9.Value);
                                    }
                                    else
                                    {
                                        break;
                                    }
                                }
                                r8 = this.ReturnHelper<IList<string>>(startCursor4, ref cursor, state => l3.AsReadOnly());
                                if (r8 != null)
                                {
                                    IParseResult<IList<string>> r10 = null;
                                    var startCursor5 = cursor;
                                    var l4 = new List<string>();
                                    while (l4.Count < 1)
                                    {
                                        IParseResult<string> r11 = null;
                                        r11 = this.orderClause(ref cursor);
                                        if (r11 != null)
                                        {
                                            l4.Add(r11.Value);
                                        }
                                        else
                                        {
                                            break;
                                        }
                                    }
                                    r10 = this.ReturnHelper<IList<string>>(startCursor5, ref cursor, state => l4.AsReadOnly());
                                    if (r10 != null)
                                    {
                                        {
                                            var len = cursor.Location - startCursor0.Location;
                                            r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                                state.Subject.Substring(startCursor0.Location, len)
                                                );
                                        }
                                    }
                                    else
                                    {
                                        cursor = startCursor0;
                                    }
                                }
                                else
                                {
                                    cursor = startCursor0;
                                }
                            }
                            else
                            {
                                cursor = startCursor0;
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            if (r0 == null)
            {
                var startCursor6 = cursor;
                IParseResult<string> r12 = null;
                r12 = this.fromClause(ref cursor);
                if (r12 != null)
                {
                    IParseResult<IList<string>> r13 = null;
                    var startCursor7 = cursor;
                    var l5 = new List<string>();
                    while (l5.Count < 1)
                    {
                        IParseResult<string> r14 = null;
                        r14 = this.whereClause(ref cursor);
                        if (r14 != null)
                        {
                            l5.Add(r14.Value);
                        }
                        else
                        {
                            break;
                        }
                    }
                    r13 = this.ReturnHelper<IList<string>>(startCursor7, ref cursor, state => l5.AsReadOnly());
                    if (r13 != null)
                    {
                        IParseResult<IList<string>> r15 = null;
                        var startCursor8 = cursor;
                        var l6 = new List<string>();
                        while (l6.Count < 1)
                        {
                            IParseResult<string> r16 = null;
                            r16 = this.groupClause(ref cursor);
                            if (r16 != null)
                            {
                                l6.Add(r16.Value);
                            }
                            else
                            {
                                break;
                            }
                        }
                        r15 = this.ReturnHelper<IList<string>>(startCursor8, ref cursor, state => l6.AsReadOnly());
                        if (r15 != null)
                        {
                            IParseResult<IList<string>> r17 = null;
                            var startCursor9 = cursor;
                            var l7 = new List<string>();
                            while (l7.Count < 1)
                            {
                                IParseResult<string> r18 = null;
                                r18 = this.havingClause(ref cursor);
                                if (r18 != null)
                                {
                                    l7.Add(r18.Value);
                                }
                                else
                                {
                                    break;
                                }
                            }
                            r17 = this.ReturnHelper<IList<string>>(startCursor9, ref cursor, state => l7.AsReadOnly());
                            if (r17 != null)
                            {
                                IParseResult<IList<string>> r19 = null;
                                var startCursor10 = cursor;
                                var l8 = new List<string>();
                                while (l8.Count < 1)
                                {
                                    IParseResult<string> r20 = null;
                                    r20 = this.orderClause(ref cursor);
                                    if (r20 != null)
                                    {
                                        l8.Add(r20.Value);
                                    }
                                    else
                                    {
                                        break;
                                    }
                                }
                                r19 = this.ReturnHelper<IList<string>>(startCursor10, ref cursor, state => l8.AsReadOnly());
                                if (r19 != null)
                                {
                                    IParseResult<string> r21 = null;
                                    r21 = this.selectClause(ref cursor);
                                    if (r21 != null)
                                    {
                                        {
                                            var len = cursor.Location - startCursor6.Location;
                                            r0 = this.ReturnHelper<string>(startCursor6, ref cursor, state =>
                                                state.Subject.Substring(startCursor6.Location, len)
                                                );
                                        }
                                    }
                                    else
                                    {
                                        cursor = startCursor6;
                                    }
                                }
                                else
                                {
                                    cursor = startCursor6;
                                }
                            }
                            else
                            {
                                cursor = startCursor6;
                            }
                        }
                        else
                        {
                            cursor = startCursor6;
                        }
                    }
                    else
                    {
                        cursor = startCursor6;
                    }
                }
                else
                {
                    cursor = startCursor6;
                }
            }
            return r0;
        }

        private IParseResult<string> selectClause(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.SELECT(ref cursor);
            if (r1 != null)
            {
                IParseResult<IList<string>> r2 = null;
                var startCursor1 = cursor;
                var l0 = new List<string>();
                while (l0.Count < 1)
                {
                    IParseResult<string> r3 = null;
                    if (r3 == null)
                    {
                        r3 = this.ParseLiteral(ref cursor, "ALL");
                    }
                    if (r3 == null)
                    {
                        r3 = this.ParseLiteral(ref cursor, "DISTINCT");
                    }
                    if (r3 != null)
                    {
                        l0.Add(r3.Value);
                    }
                    else
                    {
                        break;
                    }
                }
                r2 = this.ReturnHelper<IList<string>>(startCursor1, ref cursor, state => l0.AsReadOnly());
                if (r2 != null)
                {
                    IParseResult<IList<string>> r4 = null;
                    r4 = this.selList(ref cursor);
                    if (r4 != null)
                    {
                        IParseResult<IList<string>> r5 = null;
                        var startCursor2 = cursor;
                        var l1 = new List<string>();
                        while (l1.Count < 1)
                        {
                            IParseResult<string> r6 = null;
                            var startCursor3 = cursor;
                            IParseResult<string> r7 = null;
                            r7 = this.INTO(ref cursor);
                            if (r7 != null)
                            {
                                IParseResult<string> r8 = null;
                                r8 = this.Id(ref cursor);
                                if (r8 != null)
                                {
                                    {
                                        var len = cursor.Location - startCursor3.Location;
                                        r6 = this.ReturnHelper<string>(startCursor3, ref cursor, state =>
                                            state.Subject.Substring(startCursor3.Location, len)
                                            );
                                    }
                                }
                                else
                                {
                                    cursor = startCursor3;
                                }
                            }
                            else
                            {
                                cursor = startCursor3;
                            }
                            if (r6 != null)
                            {
                                l1.Add(r6.Value);
                            }
                            else
                            {
                                break;
                            }
                        }
                        r5 = this.ReturnHelper<IList<string>>(startCursor2, ref cursor, state => l1.AsReadOnly());
                        if (r5 != null)
                        {
                            {
                                var len = cursor.Location - startCursor0.Location;
                                r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                    state.Subject.Substring(startCursor0.Location, len)
                                    );
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<IList<string>> selList(ref Cursor cursor)
        {
            IParseResult<IList<string>> r0 = null;
            if (r0 == null)
            {
                r0 = this.columnItemList(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "*");
            }
            return r0;
        }

        private IParseResult<IList<string>> columnItemList(ref Cursor cursor)
        {
            IParseResult<IList<string>> r0 = null;
            var startCursor0 = cursor;
            var l0 = new List<string>();
            while (true)
            {
                var startCursor1 = cursor;
                if (l0.Count > 0)
                {
                    IParseResult<string> r1 = null;
                    r1 = this.comma(ref cursor);
                    if (r1 == null)
                    {
                        break;
                    }
                }
                IParseResult<string> r2 = null;
                r2 = this.columnItem(ref cursor);
                if (r2 != null)
                {
                    l0.Add(r2.Value);
                }
                else
                {
                    cursor = startCursor1;
                    break;
                }
            }
            if (l0.Count >= 1)
            {
                r0 = this.ReturnHelper<IList<string>>(startCursor0, ref cursor, state => l0.AsReadOnly());
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> columnItem(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            if (r0 == null)
            {
                r0 = this.projectionRef(ref cursor);
            }
            if (r0 == null)
            {
                var startCursor0 = cursor;
                IParseResult<string> r1 = null;
                r1 = this.columnSource(ref cursor);
                if (r1 != null)
                {
                    IParseResult<IList<string>> r2 = null;
                    var startCursor1 = cursor;
                    var l0 = new List<string>();
                    while (l0.Count < 1)
                    {
                        IParseResult<string> r3 = null;
                        var startCursor2 = cursor;
                        IParseResult<IList<string>> r4 = null;
                        var startCursor3 = cursor;
                        var l1 = new List<string>();
                        while (l1.Count < 1)
                        {
                            IParseResult<string> r5 = null;
                            r5 = this.AS(ref cursor);
                            if (r5 != null)
                            {
                                l1.Add(r5.Value);
                            }
                            else
                            {
                                break;
                            }
                        }
                        r4 = this.ReturnHelper<IList<string>>(startCursor3, ref cursor, state => l1.AsReadOnly());
                        if (r4 != null)
                        {
                            IParseResult<string> r6 = null;
                            r6 = this.Id(ref cursor);
                            if (r6 != null)
                            {
                                {
                                    var len = cursor.Location - startCursor2.Location;
                                    r3 = this.ReturnHelper<string>(startCursor2, ref cursor, state =>
                                        state.Subject.Substring(startCursor2.Location, len)
                                        );
                                }
                            }
                            else
                            {
                                cursor = startCursor2;
                            }
                        }
                        else
                        {
                            cursor = startCursor2;
                        }
                        if (r3 != null)
                        {
                            l0.Add(r3.Value);
                        }
                        else
                        {
                            break;
                        }
                    }
                    r2 = this.ReturnHelper<IList<string>>(startCursor1, ref cursor, state => l0.AsReadOnly());
                    if (r2 != null)
                    {
                        {
                            var len = cursor.Location - startCursor0.Location;
                            r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                state.Subject.Substring(startCursor0.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            return r0;
        }

        private IParseResult<string> columnSource(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            if (r0 == null)
            {
                r0 = this.aggregate(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.Id(ref cursor);
            }
            return r0;
        }

        private IParseResult<string> aggregate(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.aggregateName(ref cursor);
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.ParseLiteral(ref cursor, "(");
                if (r2 != null)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.aggregateArg(ref cursor);
                    if (r3 != null)
                    {
                        IParseResult<string> r4 = null;
                        r4 = this.ParseLiteral(ref cursor, ")");
                        if (r4 != null)
                        {
                            {
                                var len = cursor.Location - startCursor0.Location;
                                r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                    state.Subject.Substring(startCursor0.Location, len)
                                    );
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> aggregateArg(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            if (r0 == null)
            {
                r0 = this.expression(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "*");
            }
            return r0;
        }

        private IParseResult<string> aggregateName(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            if (r0 == null)
            {
                r0 = this.COUNT(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "AVG");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "MIN");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "MAX");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "STDEV");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "STDEVP");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "SUM");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "VAR");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "VARP");
            }
            return r0;
        }

        private IParseResult<string> fromClause(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.FROM(ref cursor);
            if (r1 != null)
            {
                IParseResult<IList<string>> r2 = null;
                r2 = this.idlist(ref cursor);
                if (r2 != null)
                {
                    IParseResult<IList<string>> r3 = null;
                    var startCursor1 = cursor;
                    var l0 = new List<string>();
                    while (l0.Count < 1)
                    {
                        IParseResult<string> r4 = null;
                        r4 = this.joinChain(ref cursor);
                        if (r4 != null)
                        {
                            l0.Add(r4.Value);
                        }
                        else
                        {
                            break;
                        }
                    }
                    r3 = this.ReturnHelper<IList<string>>(startCursor1, ref cursor, state => l0.AsReadOnly());
                    if (r3 != null)
                    {
                        {
                            var len = cursor.Location - startCursor0.Location;
                            r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                state.Subject.Substring(startCursor0.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> joinChain(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<IList<string>> r1 = null;
            var startCursor1 = cursor;
            var l0 = new List<string>();
            while (l0.Count < 1)
            {
                IParseResult<string> r2 = null;
                r2 = this.joinKind(ref cursor);
                if (r2 != null)
                {
                    l0.Add(r2.Value);
                }
                else
                {
                    break;
                }
            }
            r1 = this.ReturnHelper<IList<string>>(startCursor1, ref cursor, state => l0.AsReadOnly());
            if (r1 != null)
            {
                IParseResult<string> r3 = null;
                r3 = this.JOIN(ref cursor);
                if (r3 != null)
                {
                    IParseResult<IList<string>> r4 = null;
                    r4 = this.idlist(ref cursor);
                    if (r4 != null)
                    {
                        IParseResult<string> r5 = null;
                        r5 = this.ON(ref cursor);
                        if (r5 != null)
                        {
                            IParseResult<string> r6 = null;
                            r6 = this.Id(ref cursor);
                            if (r6 != null)
                            {
                                IParseResult<string> r7 = null;
                                r7 = this.ParseLiteral(ref cursor, "=");
                                if (r7 != null)
                                {
                                    IParseResult<string> r8 = null;
                                    r8 = this.Id(ref cursor);
                                    if (r8 != null)
                                    {
                                        {
                                            var len = cursor.Location - startCursor0.Location;
                                            r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                                state.Subject.Substring(startCursor0.Location, len)
                                                );
                                        }
                                    }
                                    else
                                    {
                                        cursor = startCursor0;
                                    }
                                }
                                else
                                {
                                    cursor = startCursor0;
                                }
                            }
                            else
                            {
                                cursor = startCursor0;
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> joinKind(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "INNER");
            }
            if (r0 == null)
            {
                var startCursor0 = cursor;
                IParseResult<string> r1 = null;
                r1 = this.ParseLiteral(ref cursor, "LEFT");
                if (r1 != null)
                {
                    IParseResult<IList<string>> r2 = null;
                    var startCursor1 = cursor;
                    var l0 = new List<string>();
                    while (l0.Count < 1)
                    {
                        IParseResult<string> r3 = null;
                        r3 = this.ParseLiteral(ref cursor, "OUTER");
                        if (r3 != null)
                        {
                            l0.Add(r3.Value);
                        }
                        else
                        {
                            break;
                        }
                    }
                    r2 = this.ReturnHelper<IList<string>>(startCursor1, ref cursor, state => l0.AsReadOnly());
                    if (r2 != null)
                    {
                        {
                            var len = cursor.Location - startCursor0.Location;
                            r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                state.Subject.Substring(startCursor0.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            if (r0 == null)
            {
                var startCursor2 = cursor;
                IParseResult<string> r4 = null;
                r4 = this.ParseLiteral(ref cursor, "RIGHT");
                if (r4 != null)
                {
                    IParseResult<IList<string>> r5 = null;
                    var startCursor3 = cursor;
                    var l1 = new List<string>();
                    while (l1.Count < 1)
                    {
                        IParseResult<string> r6 = null;
                        r6 = this.ParseLiteral(ref cursor, "OUTER");
                        if (r6 != null)
                        {
                            l1.Add(r6.Value);
                        }
                        else
                        {
                            break;
                        }
                    }
                    r5 = this.ReturnHelper<IList<string>>(startCursor3, ref cursor, state => l1.AsReadOnly());
                    if (r5 != null)
                    {
                        {
                            var len = cursor.Location - startCursor2.Location;
                            r0 = this.ReturnHelper<string>(startCursor2, ref cursor, state =>
                                state.Subject.Substring(startCursor2.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor2;
                    }
                }
                else
                {
                    cursor = startCursor2;
                }
            }
            return r0;
        }

        private IParseResult<string> whereClause(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.ParseLiteral(ref cursor, "WHERE");
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.expression(ref cursor);
                if (r2 != null)
                {
                    {
                        var len = cursor.Location - startCursor0.Location;
                        r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                            state.Subject.Substring(startCursor0.Location, len)
                            );
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> groupClause(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.ParseLiteral(ref cursor, "GROUP");
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.BY(ref cursor);
                if (r2 != null)
                {
                    IParseResult<IList<string>> r3 = null;
                    r3 = this.idlist(ref cursor);
                    if (r3 != null)
                    {
                        {
                            var len = cursor.Location - startCursor0.Location;
                            r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                state.Subject.Substring(startCursor0.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> havingClause(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.ParseLiteral(ref cursor, "HAVING");
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.expression(ref cursor);
                if (r2 != null)
                {
                    {
                        var len = cursor.Location - startCursor0.Location;
                        r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                            state.Subject.Substring(startCursor0.Location, len)
                            );
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> orderClause(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.ParseLiteral(ref cursor, "ORDER");
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.BY(ref cursor);
                if (r2 != null)
                {
                    IParseResult<IList<string>> r3 = null;
                    r3 = this.orderList(ref cursor);
                    if (r3 != null)
                    {
                        {
                            var len = cursor.Location - startCursor0.Location;
                            r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                state.Subject.Substring(startCursor0.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> projectionDecl(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.PROJECTION(ref cursor);
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.Id_simple(ref cursor);
                if (r2 != null)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.ParseLiteral(ref cursor, "(");
                    if (r3 != null)
                    {
                        IParseResult<IList<string>> r4 = null;
                        r4 = this.selList(ref cursor);
                        if (r4 != null)
                        {
                            IParseResult<string> r5 = null;
                            r5 = this.ParseLiteral(ref cursor, ")");
                            if (r5 != null)
                            {
                                {
                                    var len = cursor.Location - startCursor0.Location;
                                    r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                        state.Subject.Substring(startCursor0.Location, len)
                                        );
                                }
                            }
                            else
                            {
                                cursor = startCursor0;
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> projectionRef(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            if (r0 == null)
            {
                var startCursor0 = cursor;
                IParseResult<string> r1 = null;
                r1 = this.ParseLiteral(ref cursor, "<");
                if (r1 != null)
                {
                    IParseResult<string> r2 = null;
                    r2 = this.Id_simple(ref cursor);
                    if (r2 != null)
                    {
                        IParseResult<string> r3 = null;
                        r3 = this.ParseLiteral(ref cursor, ">");
                        if (r3 != null)
                        {
                            {
                                var len = cursor.Location - startCursor0.Location;
                                r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                    state.Subject.Substring(startCursor0.Location, len)
                                    );
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            if (r0 == null)
            {
                var startCursor1 = cursor;
                IParseResult<string> r4 = null;
                r4 = this.Id_simple(ref cursor);
                if (r4 != null)
                {
                    IParseResult<string> r5 = null;
                    r5 = this.dot(ref cursor);
                    if (r5 != null)
                    {
                        IParseResult<string> r6 = null;
                        r6 = this.ParseLiteral(ref cursor, "<");
                        if (r6 != null)
                        {
                            IParseResult<string> r7 = null;
                            r7 = this.Id_simple(ref cursor);
                            if (r7 != null)
                            {
                                IParseResult<string> r8 = null;
                                r8 = this.ParseLiteral(ref cursor, ">");
                                if (r8 != null)
                                {
                                    {
                                        var len = cursor.Location - startCursor1.Location;
                                        r0 = this.ReturnHelper<string>(startCursor1, ref cursor, state =>
                                            state.Subject.Substring(startCursor1.Location, len)
                                            );
                                    }
                                }
                                else
                                {
                                    cursor = startCursor1;
                                }
                            }
                            else
                            {
                                cursor = startCursor1;
                            }
                        }
                        else
                        {
                            cursor = startCursor1;
                        }
                    }
                    else
                    {
                        cursor = startCursor1;
                    }
                }
                else
                {
                    cursor = startCursor1;
                }
            }
            return r0;
        }

        private IParseResult<IList<string>> exprList(ref Cursor cursor)
        {
            IParseResult<IList<string>> r0 = null;
            var startCursor0 = cursor;
            var l0 = new List<string>();
            while (true)
            {
                var startCursor1 = cursor;
                if (l0.Count > 0)
                {
                    IParseResult<string> r1 = null;
                    r1 = this.comma(ref cursor);
                    if (r1 == null)
                    {
                        break;
                    }
                }
                IParseResult<string> r2 = null;
                r2 = this.expression(ref cursor);
                if (r2 != null)
                {
                    l0.Add(r2.Value);
                }
                else
                {
                    cursor = startCursor1;
                    break;
                }
            }
            if (l0.Count >= 1)
            {
                r0 = this.ReturnHelper<IList<string>>(startCursor0, ref cursor, state => l0.AsReadOnly());
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> expression(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var storageKey = "expression:" + cursor.StateKey + ":" + cursor.Location;
            if (this.storage.ContainsKey(storageKey))
            {
                r0 = (IParseResult<string>)this.storage[storageKey];
                if (r0 != null)
                {
                    cursor = r0.EndCursor;
                }
                return r0;
            }
            this.storage[storageKey] = null;
            var startCursor0 = cursor;
            while (true)
            {
                IParseResult<string> r1 = null;
                if (r1 == null)
                {
                    r1 = this.term(ref cursor);
                }
                if (r1 == null)
                {
                    r1 = this.unExpr(ref cursor);
                }
                if (r1 == null)
                {
                    r1 = this.binExpr(ref cursor);
                }
                if (r1 == null || (r0 != null && r0.EndCursor.Location >= r1.EndCursor.Location))
                {
                    break;
                }
                this.storage[storageKey] = r0 = r1;
                cursor = startCursor0;
            }
            if (r0 != null)
            {
                cursor = r0.EndCursor;
            }
            return r0;
        }

        private IParseResult<string> term(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            if (r0 == null)
            {
                r0 = this.Id(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.string_literal(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.number(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.funCall(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.tuple(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.parSelectStmt(ref cursor);
            }
            return r0;
        }

        private IParseResult<string> tuple(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.ParseLiteral(ref cursor, "(");
            if (r1 != null)
            {
                IParseResult<IList<string>> r2 = null;
                r2 = this.exprList(ref cursor);
                if (r2 != null)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.ParseLiteral(ref cursor, ")");
                    if (r3 != null)
                    {
                        {
                            var len = cursor.Location - startCursor0.Location;
                            r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                state.Subject.Substring(startCursor0.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> parSelectStmt(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.ParseLiteral(ref cursor, "(");
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.selectStmt(ref cursor);
                if (r2 != null)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.ParseLiteral(ref cursor, ")");
                    if (r3 != null)
                    {
                        {
                            var len = cursor.Location - startCursor0.Location;
                            r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                state.Subject.Substring(startCursor0.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> unExpr(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.unOp(ref cursor);
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.term(ref cursor);
                if (r2 != null)
                {
                    {
                        var len = cursor.Location - startCursor0.Location;
                        r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                            state.Subject.Substring(startCursor0.Location, len)
                            );
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> unOp(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            if (r0 == null)
            {
                r0 = this.NOT(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "+");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "-");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "~");
            }
            return r0;
        }

        private IParseResult<string> binExpr(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var storageKey = "binExpr:" + cursor.StateKey + ":" + cursor.Location;
            if (this.storage.ContainsKey(storageKey))
            {
                r0 = (IParseResult<string>)this.storage[storageKey];
                if (r0 != null)
                {
                    cursor = r0.EndCursor;
                }
                return r0;
            }
            this.storage[storageKey] = null;
            var startCursor0 = cursor;
            while (true)
            {
                IParseResult<string> r1 = null;
                var startCursor1 = cursor;
                IParseResult<string> r2 = null;
                r2 = this.expression(ref cursor);
                if (r2 != null)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.binOp(ref cursor);
                    if (r3 != null)
                    {
                        IParseResult<string> r4 = null;
                        r4 = this.expression(ref cursor);
                        if (r4 != null)
                        {
                            {
                                var len = cursor.Location - startCursor1.Location;
                                r1 = this.ReturnHelper<string>(startCursor1, ref cursor, state =>
                                    state.Subject.Substring(startCursor1.Location, len)
                                    );
                            }
                        }
                        else
                        {
                            cursor = startCursor1;
                        }
                    }
                    else
                    {
                        cursor = startCursor1;
                    }
                }
                else
                {
                    cursor = startCursor1;
                }
                if (r1 == null || (r0 != null && r0.EndCursor.Location >= r1.EndCursor.Location))
                {
                    break;
                }
                this.storage[storageKey] = r0 = r1;
                cursor = startCursor0;
            }
            if (r0 != null)
            {
                cursor = r0.EndCursor;
            }
            return r0;
        }

        private IParseResult<string> binOp(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "+");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "-");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "*");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "/");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "%");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "&");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "|");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "^");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "=");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, ">");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "<");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, ">=");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "<>");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "!=");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "!<");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "!>");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "AND");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "OR");
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "LIKE");
            }
            if (r0 == null)
            {
                var startCursor0 = cursor;
                IParseResult<string> r1 = null;
                r1 = this.NOT(ref cursor);
                if (r1 != null)
                {
                    IParseResult<string> r2 = null;
                    r2 = this.ParseLiteral(ref cursor, "LIKE");
                    if (r2 != null)
                    {
                        {
                            var len = cursor.Location - startCursor0.Location;
                            r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                state.Subject.Substring(startCursor0.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            if (r0 == null)
            {
                r0 = this.ParseLiteral(ref cursor, "IN");
            }
            if (r0 == null)
            {
                var startCursor1 = cursor;
                IParseResult<string> r3 = null;
                r3 = this.NOT(ref cursor);
                if (r3 != null)
                {
                    IParseResult<string> r4 = null;
                    r4 = this.ParseLiteral(ref cursor, "IN");
                    if (r4 != null)
                    {
                        {
                            var len = cursor.Location - startCursor1.Location;
                            r0 = this.ReturnHelper<string>(startCursor1, ref cursor, state =>
                                state.Subject.Substring(startCursor1.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor1;
                    }
                }
                else
                {
                    cursor = startCursor1;
                }
            }
            return r0;
        }

        private IParseResult<string> betweenExpr(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.expression(ref cursor);
            if (r1 != null)
            {
                IParseResult<IList<string>> r2 = null;
                var startCursor1 = cursor;
                var l0 = new List<string>();
                while (l0.Count < 1)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.NOT(ref cursor);
                    if (r3 != null)
                    {
                        l0.Add(r3.Value);
                    }
                    else
                    {
                        break;
                    }
                }
                r2 = this.ReturnHelper<IList<string>>(startCursor1, ref cursor, state => l0.AsReadOnly());
                if (r2 != null)
                {
                    IParseResult<string> r4 = null;
                    r4 = this.ParseLiteral(ref cursor, "BETWEEN");
                    if (r4 != null)
                    {
                        IParseResult<string> r5 = null;
                        r5 = this.expression(ref cursor);
                        if (r5 != null)
                        {
                            IParseResult<string> r6 = null;
                            r6 = this.ParseLiteral(ref cursor, "AND");
                            if (r6 != null)
                            {
                                IParseResult<string> r7 = null;
                                r7 = this.expression(ref cursor);
                                if (r7 != null)
                                {
                                    {
                                        var len = cursor.Location - startCursor0.Location;
                                        r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                            state.Subject.Substring(startCursor0.Location, len)
                                            );
                                    }
                                }
                                else
                                {
                                    cursor = startCursor0;
                                }
                            }
                            else
                            {
                                cursor = startCursor0;
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> funCall(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.Id(ref cursor);
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.ParseLiteral(ref cursor, "(");
                if (r2 != null)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.funArgs(ref cursor);
                    if (r3 != null)
                    {
                        IParseResult<string> r4 = null;
                        r4 = this.ParseLiteral(ref cursor, ")");
                        if (r4 != null)
                        {
                            {
                                var len = cursor.Location - startCursor0.Location;
                                r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                    state.Subject.Substring(startCursor0.Location, len)
                                    );
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> funArgs(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            if (r0 == null)
            {
                r0 = this.selectStmt(ref cursor);
            }
            if (r0 == null)
            {
                r0 = this.exprList(ref cursor);
            }
            return r0;
        }

        private IParseResult<string> inStmt(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.expression(ref cursor);
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                r2 = this.ParseLiteral(ref cursor, "IN");
                if (r2 != null)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.ParseLiteral(ref cursor, "(");
                    if (r3 != null)
                    {
                        IParseResult<IList<string>> r4 = null;
                        r4 = this.exprList(ref cursor);
                        if (r4 != null)
                        {
                            IParseResult<string> r5 = null;
                            r5 = this.ParseLiteral(ref cursor, ")");
                            if (r5 != null)
                            {
                                {
                                    var len = cursor.Location - startCursor0.Location;
                                    r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                        state.Subject.Substring(startCursor0.Location, len)
                                        );
                                }
                            }
                            else
                            {
                                cursor = startCursor0;
                            }
                        }
                        else
                        {
                            cursor = startCursor0;
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> dot(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, ".");
            return r0;
        }

        private IParseResult<string> comma(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, ",");
            return r0;
        }

        private IParseResult<
            #line 71 "Grammar.peg"
           string
            #line default
            > Id_simple(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            if (r0 == null)
            {
                var startCursor0 = cursor;
                var l0 = new List<string>();
                while (true)
                {
                    IParseResult<string> r1 = null;
                    r1 = this.ParseClass(ref cursor, "AZ");
                    if (r1 != null)
                    {
                        l0.Add(r1.Value);
                    }
                    else
                    {
                        break;
                    }
                }
                if (l0.Count >= 1)
                {
                    r0 = this.ReturnHelper<IList<string>>(startCursor0, ref cursor, state => l0.AsReadOnly());
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            if (r0 == null)
            {
                var startCursor1 = cursor;
                IParseResult<string> r2 = null;
                r2 = this.ParseLiteral(ref cursor, "[");
                if (r2 != null)
                {
                    IParseResult<IList<string>> r3 = null;
                    var startCursor2 = cursor;
                    var l1 = new List<string>();
                    while (true)
                    {
                        IParseResult<string> r4 = null;
                        r4 = this.ParseClass(ref cursor, "AZ");
                        if (r4 != null)
                        {
                            l1.Add(r4.Value);
                        }
                        else
                        {
                            break;
                        }
                    }
                    r3 = this.ReturnHelper<IList<string>>(startCursor2, ref cursor, state => l1.AsReadOnly());
                    if (r3 != null)
                    {
                        IParseResult<string> r5 = null;
                        r5 = this.ParseLiteral(ref cursor, "]");
                        if (r5 != null)
                        {
                            {
                                var len = cursor.Location - startCursor1.Location;
                                r0 = this.ReturnHelper<string>(startCursor1, ref cursor, state =>
                                    state.Subject.Substring(startCursor1.Location, len)
                                    );
                            }
                        }
                        else
                        {
                            cursor = startCursor1;
                        }
                    }
                    else
                    {
                        cursor = startCursor1;
                    }
                }
                else
                {
                    cursor = startCursor1;
                }
            }
            if (r0 == null)
            {
                var startCursor3 = cursor;
                IParseResult<string> r6 = null;
                r6 = this.ParseClass(ref cursor, "\"\"");
                if (r6 != null)
                {
                    IParseResult<IList<string>> r7 = null;
                    var startCursor4 = cursor;
                    var l2 = new List<string>();
                    while (true)
                    {
                        IParseResult<string> r8 = null;
                        r8 = this.ParseClass(ref cursor, "AZ");
                        if (r8 != null)
                        {
                            l2.Add(r8.Value);
                        }
                        else
                        {
                            break;
                        }
                    }
                    r7 = this.ReturnHelper<IList<string>>(startCursor4, ref cursor, state => l2.AsReadOnly());
                    if (r7 != null)
                    {
                        IParseResult<string> r9 = null;
                        r9 = this.ParseClass(ref cursor, "\"\"");
                        if (r9 != null)
                        {
                            {
                                var len = cursor.Location - startCursor3.Location;
                                r0 = this.ReturnHelper<string>(startCursor3, ref cursor, state =>
                                    state.Subject.Substring(startCursor3.Location, len)
                                    );
                            }
                        }
                        else
                        {
                            cursor = startCursor3;
                        }
                    }
                    else
                    {
                        cursor = startCursor3;
                    }
                }
                else
                {
                    cursor = startCursor3;
                }
            }
            return r0;
        }

        private IParseResult<string> number(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<IList<string>> r1 = null;
            var startCursor1 = cursor;
            var l0 = new List<string>();
            while (true)
            {
                IParseResult<string> r2 = null;
                r2 = this.ParseClass(ref cursor, "09");
                if (r2 != null)
                {
                    l0.Add(r2.Value);
                }
                else
                {
                    break;
                }
            }
            if (l0.Count >= 1)
            {
                r1 = this.ReturnHelper<IList<string>>(startCursor1, ref cursor, state => l0.AsReadOnly());
            }
            else
            {
                cursor = startCursor1;
            }
            if (r1 != null)
            {
                IParseResult<IList<string>> r3 = null;
                var startCursor2 = cursor;
                var l1 = new List<string>();
                while (l1.Count < 1)
                {
                    IParseResult<string> r4 = null;
                    r4 = this.ParseLiteral(ref cursor, ".");
                    if (r4 != null)
                    {
                        l1.Add(r4.Value);
                    }
                    else
                    {
                        break;
                    }
                }
                r3 = this.ReturnHelper<IList<string>>(startCursor2, ref cursor, state => l1.AsReadOnly());
                if (r3 != null)
                {
                    IParseResult<IList<string>> r5 = null;
                    var startCursor3 = cursor;
                    var l2 = new List<string>();
                    while (true)
                    {
                        IParseResult<string> r6 = null;
                        r6 = this.ParseClass(ref cursor, "09");
                        if (r6 != null)
                        {
                            l2.Add(r6.Value);
                        }
                        else
                        {
                            break;
                        }
                    }
                    r5 = this.ReturnHelper<IList<string>>(startCursor3, ref cursor, state => l2.AsReadOnly());
                    if (r5 != null)
                    {
                        {
                            var len = cursor.Location - startCursor0.Location;
                            r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                state.Subject.Substring(startCursor0.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> string_literal(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            var startCursor0 = cursor;
            IParseResult<string> r1 = null;
            r1 = this.ParseLiteral(ref cursor, "\'");
            if (r1 != null)
            {
                IParseResult<string> r2 = null;
                if (r2 == null)
                {
                    r2 = this.ParseClass(ref cursor, "\'\'", negated: true);
                }
                if (r2 == null)
                {
                    r2 = this.ParseLiteral(ref cursor, "");
                }
                if (r2 != null)
                {
                    IParseResult<string> r3 = null;
                    r3 = this.ParseLiteral(ref cursor, "\'");
                    if (r3 != null)
                    {
                        {
                            var len = cursor.Location - startCursor0.Location;
                            r0 = this.ReturnHelper<string>(startCursor0, ref cursor, state =>
                                state.Subject.Substring(startCursor0.Location, len)
                                );
                        }
                    }
                    else
                    {
                        cursor = startCursor0;
                    }
                }
                else
                {
                    cursor = startCursor0;
                }
            }
            else
            {
                cursor = startCursor0;
            }
            return r0;
        }

        private IParseResult<string> CREATE(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "CREATE");
            return r0;
        }

        private IParseResult<string> TABLE(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "TABLE");
            return r0;
        }

        private IParseResult<string> NULL(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "NULL");
            return r0;
        }

        private IParseResult<string> NOT(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "NOT");
            return r0;
        }

        private IParseResult<string> CONSTRAINT(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "CONSTRAINT");
            return r0;
        }

        private IParseResult<string> PRIMARY(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "PRIMARY");
            return r0;
        }

        private IParseResult<string> KEY(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "KEY");
            return r0;
        }

        private IParseResult<string> UNIQUE(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "UNIQUE");
            return r0;
        }

        private IParseResult<string> INDEX(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "INDEX");
            return r0;
        }

        private IParseResult<string> ON(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "ON");
            return r0;
        }

        private IParseResult<string> WITH(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "WITH");
            return r0;
        }

        private IParseResult<string> ALTER(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "ALTER");
            return r0;
        }

        private IParseResult<string> ADD(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "ADD");
            return r0;
        }

        private IParseResult<string> COLUMN(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "COLUMN");
            return r0;
        }

        private IParseResult<string> DROP(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "DROP");
            return r0;
        }

        private IParseResult<string> INSERT(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "INSERT");
            return r0;
        }

        private IParseResult<string> INTO(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "INTO");
            return r0;
        }

        private IParseResult<string> VALUES(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "VALUES");
            return r0;
        }

        private IParseResult<string> UPDATE(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "UPDATE");
            return r0;
        }

        private IParseResult<string> SET(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "SET");
            return r0;
        }

        private IParseResult<string> DELETE(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "DELETE");
            return r0;
        }

        private IParseResult<string> FROM(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "FROM");
            return r0;
        }

        private IParseResult<string> SELECT(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "SELECT");
            return r0;
        }

        private IParseResult<string> AS(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "AS");
            return r0;
        }

        private IParseResult<string> COUNT(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "COUNT");
            return r0;
        }

        private IParseResult<string> JOIN(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "JOIN");
            return r0;
        }

        private IParseResult<string> BY(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "BY");
            return r0;
        }

        private IParseResult<string> PROJECTION(ref Cursor cursor)
        {
            IParseResult<string> r0 = null;
            r0 = this.ParseLiteral(ref cursor, "PROJECTION");
            return r0;
        }

        private IParseResult<string> ParseLiteral(ref Cursor cursor, string literal, bool ignoreCase = false)
        {
            if (cursor.Location + literal.Length <= cursor.Subject.Length)
            {
                var substr = cursor.Subject.Substring(cursor.Location, literal.Length);
                if (ignoreCase ? substr.Equals(literal, StringComparison.OrdinalIgnoreCase) : substr == literal)
                {
                    var endCursor = cursor.Advance(substr.Length);
                    var result = this.ReturnHelper<string>(cursor, ref endCursor, state => substr);
                    cursor = endCursor;
                    return result;
                }
            }
            return null;
        }

        private IParseResult<string> ParseClass(ref Cursor cursor, string characterRanges, bool negated = false, bool ignoreCase = false)
        {
            if (cursor.Location + 1 <= cursor.Subject.Length)
            {
                var c = cursor.Subject[cursor.Location];
                bool match = false;
                for (int i = 0; !match && i < characterRanges.Length; i += 2)
                {
                    match = c >= characterRanges[i] && c <= characterRanges[i + 1];
                }
                if (!match && ignoreCase && (char.IsUpper(c) || char.IsLower(c)))
                {
                    var cs = c.ToString();
                    for (int i = 0; !match && i < characterRanges.Length; i += 2)
                    {
                        var min = characterRanges[i];
                        var max = characterRanges[i + 1];
                        for (char o = min; !match && o <= max; o++)
                        {
                            match = (char.IsUpper(o) || char.IsLower(o)) && cs.Equals(o.ToString(), StringComparison.CurrentCultureIgnoreCase);
                        }
                    }
                }
                if (match ^ negated)
                {
                    var endCursor = cursor.Advance(1);
                    var substr = cursor.Subject.Substring(cursor.Location, 1);
                    var result = this.ReturnHelper<string>(cursor, ref endCursor, state => substr);
                    cursor = endCursor;
                    return result;
                }
            }
            return null;
        }

        private IParseResult<string> ParseAny(ref Cursor cursor)
        {
            if (cursor.Location + 1 <= cursor.Subject.Length)
            {
                var substr = cursor.Subject.Substring(cursor.Location, 1);
                var endCursor = cursor.Advance(1);
                var result = this.ReturnHelper<string>(cursor, ref endCursor, state => substr);
                cursor = endCursor;
                return result;
            }
            return null;
        }

        private IParseResult<T> ReturnHelper<T>(Cursor startCursor, ref Cursor endCursor, Func<Cursor, T> wrappedCode)
        {
            var result = wrappedCode(endCursor);
            var lexical = result as ILexical;
            if (lexical != null && lexical.StartCursor == null && lexical.EndCursor == null)
            {
                lexical.StartCursor = startCursor;
                lexical.EndCursor = endCursor;
            }
            return new ParseResult<T>(startCursor, endCursor, result);
        }

        private Exception ExceptionHelper(Cursor cursor, Func<Cursor, string> wrappedCode)
        {
            var ex = new FormatException(wrappedCode(cursor));
            ex.Data["cursor"] = cursor;
            return ex;
        }

        private T ValueOrDefault<T>(IParseResult<T> result)
        {
            return result == null
                ? default(T)
                : result.Value;
        }
    }
}
